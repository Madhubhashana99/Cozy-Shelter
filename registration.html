<?php
  include 'login.php';
?>
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/sign_in.css">
    <title>registration</title>
  </head>
  <body>
        <div class="container">
      <div class="header">
        <h2>Create Account</h2>
      </div>
      <form id="form" class="form" action="sign_in.php" method="post">
        <div class="form-control" >
          <label for="username">Username</label>
          <input class="input" type="text" placeholder="catlover123" id="username" name="uname" />
          <i class="fas fa-check-circle"></i>
          <i class="fas fa-exclamation-circle"></i>
          <small>Error message</small>
        </div>
        <div class="form-control">
          <label for="username">Email</label>
          <input class="input" type="email" placeholder="a@example.com" id="email" name="email" />
          <i class="fas fa-check-circle"></i>
          <i class="fas fa-exclamation-circle"></i>
          <small>Error message</small>
        </div>
        <div class="form-control">
          <label for="username">Password</label>
          <input class="input" type="password" placeholder="Password" id="password" name="pwd" />
          <i class="fas fa-check-circle"></i>
          <i class="fas fa-exclamation-circle"></i>
          <small>Error message</small>
        </div>
        <div class="form-control">
          <label for="username">Confirm Password</label>
          <input class="input" type="password" placeholder="confirm password" id="password2" name="pwdcon" />
          <i class="fas fa-check-circle"></i>
          <i class="fas fa-exclamation-circle"></i>
          <small>Error message</small>
        </div>
        <button type="submit" id="submit" name="submit" class="btn btn-info">Register</button>
      </form>
    </div>





   
    <script type="text/javascript">
        const form = document.getElementById('form');
        const username = document.getElementById('username');
        const email = document.getElementById('email');
        const password = document.getElementById('password');
        const password2 = document.getElementById('password2');

        form.addEventListener('submit', e => {

          if (!checkInputs()) {
          e.preventDefault();
          e.stopPropagation();
          }
          
        });
        // function validation(){
        //   if (!checkInputs()) {
        //   e.preventDefault();
        //   e.stopPropagation();
        //   }
        // }

        function checkInputs() {
          // trim to remove the whitespaces
          const usernameValue = username.value.trim();
          const emailValue = email.value.trim();
          const passwordValue = password.value.trim();
          const password2Value = password2.value.trim();
          let factor = true;

          if(usernameValue === '') {
            setErrorFor(username, 'Username cannot be blank');
            factor = false;
          } else {
            setSuccessFor(username);
            factor = true ;
          }
          
          if(emailValue === '') {
            setErrorFor(email, 'Email cannot be blank');
            factor = false;
          } else if (!isEmail(emailValue)) {
            setErrorFor(email, 'Not a valid email');
            factor = false;
          } else {
            setSuccessFor(email);
            factor = true;
          }
          
          if(passwordValue === '') {
            setErrorFor(password, 'Password cannot be blank');
            factor = false;
          } else {
            setSuccessFor(password);
            factor = true;
          }
          
          if(password2Value === '') {
            setErrorFor(password2, 'Password2 cannot be blank');
            factor = false;
          } else if(passwordValue !== password2Value) {
            setErrorFor(password2, 'Passwords does not match');
            factor = false;
          } else{
            setSuccessFor(password2);
            factor = true;
          }

          return factor;
        }

        function setErrorFor(input, message) {
          const formControl = input.parentElement;
          const small = formControl.querySelector('small');
          formControl.className = 'form-control error';
          small.innerText = message;
        }

        function setSuccessFor(input) {
          const formControl = input.parentElement;
          formControl.className = 'form-control success';
        }
          
        function isEmail(email) {
          return /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email);
        }

    </script>
 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>


  </body>
</html>